{% load static %}

<!-- Any Web Contents is here-->
<div class="row justify-content-center">

    <script>
        var patients = new Array();

        // Autogenerated: backend object_list reflection
        {% for patient in object_list %}
        {% autoescape on %}
        patients['{{ forloop.counter0 }}'] = {
            'id': "{{ patient.id }}",
            'username': "{{ patient.username }}",
            'first_name': "{{ patient.first_name }}",
            'last_name': "{{ patient.last_name }}",
            'age': "{{ patient.age }}",
            'sex': "{{ patient.sex }}",
            'blodgroup': "{{ patient.blod_group }}",
            'last_login': "{{ patient.last_login }}",
            'date_joined': "{{ patient.date_joined }}",
            'icon_path': "{{ patient.icon_path }}" || 'default_profile.png'
        };
        {% endautoescape %}
        {% endfor %}
    
    </script>
    
    <script src="{% static 'js/patient_list_items_listeners.js' %}"></script>
    
    
    <!-- List Section Title-->
    <div class="col-12 text-center fs-5 fw-bold">
        Gestion de Usuarios
    </div>

    <!-- Registreds Users List -->
    <div class="col-11 col-md-10 mt-2 overflow-auto" style="height: 50vh;">
        <table class="table">

            <thead class="border-bottom border-dark">
                <th scope="col" class="col-6 text-center" colspan="2">Nombre</th>
                <th scope="col" class="col-4 text-center">Ultimo Acceso</th>
                <th scope="col" class="col-4 text-center">Accion</th>
            </thead>
            
            <tbody class="text-center">

                {% for patient in object_list %}

                <!-- Registred User Data Entry -->
                <tr class="border-bottom border-dark">
                    <td class="col-1 text-center">
                        <img class="img-rounded" src="/static/img/profiles/{{ patient.icon_path }}"
                            width="40px" height="40px">
                    </td>

                    <td class="col-5">
                        {{ patient.first_name }} {{ patient.last_name }}
                    </td>
                    
                    <td class="col-2 text-center">
                        {% if patient.last_login is not None %}
                        {{patient.last_login}}
                        {% else %}
                        NO LOGGUED
                        {% endif %}
                    </td>

                    <td class="col-4 text-center">

                        <button class="btn btn-sm btn-secondary text-nowrap detail-patient-button" data-bs-toggle="modal"
                            data-bs-target="#patientDetailsDialog" index="{{ forloop.counter0 }}">
                            <img src="{% static 'img/see-ligth.svg' %}" width="20" height="20"
                                class="img-fluid mb-1 me-sm-1">
                            <span class="d-none d-sm-inline">
                                DETALLES
                            </span>
                        </button>

                    </td>
                </tr>

                {% endfor%}
            
            </tbody>

        </table>
    </div>

    <!-- User actions-->
    <div class="col-11 col-md-10 mt-2 text-end">
        <button class="btn btn-sm --button p-1 px-3 me-3" data-bs-toggle="modal"
            data-bs-target="#userSiginDialog">
            <img src="{% static 'img/add-profile.svg' %}" width="20" height="20"
                class="img-fluid mb-1 me-1">
            NUEVO
        </button>
    </div>

    <!-- Include togleables modal dialogs -->
    {% include 'modals/modal_signin_patient.html' %}
    {% include 'modals/modal_detail_patient.html' %}

</div>